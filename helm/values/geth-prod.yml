# âš ï¸  MAINNET GETH CONFIGURATION - SYNC MODE COMPARISON
# This shows different sync modes and their implications

# ğŸ”„ SYNC MODE OPTIONS (choose ONE):

# ğŸª¶ LIGHT SYNC MODE (Minimal resources)
extraArgs:
- "--mainnet"
- "--syncmode=light" # ğŸª¶ Light sync - downloads block headers only
- "--cache=512" # 512MB cache (light mode needs less)
- "--maxpeers=25" # Fewer peers for light mode

# ğŸš€ SNAP SYNC MODE (Recommended for mainnet)
# extraArgs:
# - "--mainnet" 
# - "--syncmode=snap"        # ğŸš€ Snap sync - fast sync with state snapshots
# - "--cache=4096"          # 4GB cache for optimal performance
# - "--maxpeers=50"

# ğŸ“š FULL SYNC MODE (Complete but slow)
# extraArgs:
# - "--mainnet"
# - "--syncmode=full"        # ğŸ“š Full sync - downloads and validates everything
# - "--cache=4096"          # 4GB cache needed
# - "--maxpeers=50"

# ğŸ—„ï¸ STORAGE REQUIREMENTS BY SYNC MODE
# Light Sync: ~2-5GB (headers + recent state)
# Snap Sync: ~600-800GB (state snapshot + recent blocks)  
# Full Sync: ~1500GB+ (complete blockchain history)

persistence:
  enabled: true
  accessModes:
  - ReadWriteOnce
  # Choose storage size based on sync mode:
  size: 50Gi # ğŸª¶ Light sync: 50GB is plenty
  # size: 1000Gi            # ï¿½ Snap sync: 1TB recommended  
  # size: 1500Gi            # ğŸ“š Full sync: 1.5TB+ required
  storageClassName: fast-ssd

extraEnv:
- name: GETH_PORT
  value: "30303"

# ğŸš€ RESOURCE REQUIREMENTS BY SYNC MODE
resources:
  # ğŸª¶ LIGHT SYNC RESOURCES (minimal)
  requests:
    cpu: 500m # 0.5 CPU cores
    memory: 1Gi # 1GB RAM
  limits:
    cpu: 1000m # 1 CPU core max
    memory: 2Gi # 2GB RAM max
  # ğŸš€ SNAP SYNC RESOURCES (recommended for mainnet)
  # requests:
  #   cpu: 2000m            # 2 CPU cores
  #   memory: 8Gi           # 8GB RAM
  # limits:
  #   cpu: 4000m            # 4 CPU cores max
  #   memory: 16Gi          # 16GB RAM max

  # ğŸ“š FULL SYNC RESOURCES (maximum performance)
  # requests:
  #   cpu: 4000m            # 4 CPU cores
  #   memory: 16Gi          # 16GB RAM
  # limits:
  #   cpu: 8000m            # 8 CPU cores max
  #   memory: 32Gi          # 32GB RAM max

  # ğŸŒ Service Configuration
service:
  type: LoadBalancer
  ports:
  - name: http
    port: 8545
    targetPort: 8545
  - name: ws
    port: 8546
    targetPort: 8546
  - name: p2p
    port: 30303
    targetPort: 30303

# ğŸ¥ Health Checks (adjusted per sync mode)
livenessProbe:
  tcpSocket:
    port: 8545
  # Light sync: starts faster
  initialDelaySeconds: 60 # ğŸª¶ Light: 1 minute
  # initialDelaySeconds: 300   # ï¿½ Snap: 5 minutes  
  # initialDelaySeconds: 600   # ğŸ“š Full: 10 minutes
  periodSeconds: 30
  failureThreshold: 10

readinessProbe:
  tcpSocket:
    port: 8545
  # Sync time varies dramatically by mode
  initialDelaySeconds: 180 # ğŸª¶ Light: 3 minutes (fast sync)
  # initialDelaySeconds: 1800  # ğŸš€ Snap: 30 minutes (initial snapshot)
  # initialDelaySeconds: 3600  # ğŸ“š Full: 1+ hours (slow initial sync)
  periodSeconds: 60
  failureThreshold: 20

# ğŸ“Š SYNC MODE COMPARISON TABLE
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚    Mode     â”‚  Sync Time   â”‚   Storage    â”‚  Features    â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ Light       â”‚ 5-15 mins    â”‚ 2-5GB        â”‚ Limited APIs â”‚
# â”‚ Snap        â”‚ 2-6 hours    â”‚ 600-800GB    â”‚ Full APIs    â”‚
# â”‚ Full        â”‚ 3-7 days     â”‚ 1500GB+      â”‚ Full Archive â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ”’ SECURITY & LIMITATIONS BY SYNC MODE
# ğŸ”’ SECURITY & LIMITATIONS BY SYNC MODE

# ğŸª¶ LIGHT SYNC LIMITATIONS:
# âœ… Pros: Fast, minimal resources, good for most dApps
# âŒ Cons: Limited historical data, depends on full nodes
# âŒ No: eth_getLogs for old blocks, archive state access
# âœ… Has: Current state, recent transactions, block headers

# ğŸš€ SNAP SYNC (RECOMMENDED):
# âœ… Pros: Fast initial sync, full node capabilities, complete APIs
# âœ… Has: Full state, all RPC methods, good performance
# âš ï¸  Note: Downloads state snapshot from trusted peers

# ğŸ“š FULL SYNC (TRADITIONAL):
# âœ… Pros: Complete validation, full archive, maximum security
# âœ… Has: Complete blockchain history, all data locally verified
# âŒ Cons: Very slow, requires massive storage and bandwidth

# ğŸ’° ESTIMATED MONTHLY COSTS BY SYNC MODE:

# ğŸª¶ LIGHT SYNC COSTS:
# - 50GB SSD Storage: $5-10/month
# - 1 CPU + 2GB RAM: $20-40/month  
# - Network bandwidth: $10-20/month
# - TOTAL: $35-70/month

# ğŸš€ SNAP SYNC COSTS:
# - 1TB SSD Storage: $100-200/month
# - 4 CPU + 16GB RAM: $200-400/month  
# - Network bandwidth: $30-60/month
# - TOTAL: $330-660/month

# ğŸ“š FULL SYNC COSTS:
# - 1.5TB+ SSD Storage: $150-300/month
# - 8 CPU + 32GB RAM: $400-800/month  
# - Network bandwidth: $50-100/month
# - TOTAL: $600-1200/month! ğŸ’¸

# ğŸ“Š Labels
labels:
  environment: production
  network: mainnet
  # Uncomment the sync mode you're using:
  sync-mode: light # ğŸª¶ Light sync
  # sync-mode: snap         # ï¿½ Snap sync  
  # sync-mode: full         # ğŸ“š Full sync
  cost-category: moderate # light: low, snap: moderate, full: expensive

# ğŸ¯ RECOMMENDATION BY USE CASE:
#
# ğŸ  DEVELOPMENT/TESTING:
#   Use: Sepolia testnet (current setup) - FREE!
#
# ğŸ“± DAPP FRONTEND:
#   Use: Light sync - fast, cheap, sufficient for most apps
#
# ğŸ¢ PRODUCTION BACKEND:
#   Use: Snap sync - good balance of speed, cost, and features
#
# ğŸ¦ FINANCIAL/ANALYTICS:
#   Use: Full sync - complete data, maximum security
#
# ğŸ’¡ HYBRID APPROACH:
#   Use: External RPC (Infura/Alchemy) + Light node for redundancy
